<!DOCTYPE html>

<html lang="en">

<head>

  <!-- SITE TITTLE -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>BucketList</title>

  <!-- Plugins css Style -->
  <link href='/assets/plugins/fontawesome-5.15.2/css/all.min.css' rel='stylesheet'>
  <link href='/assets/plugins/fontawesome-5.15.2/css/fontawesome.min.css' rel='stylesheet'>
  <link href="/assets/plugins/animate/animate.css" rel="stylesheet">
  <link href="/assets/plugins/menuzord/css/menuzord.css" rel="stylesheet">
  <link href="/assets/plugins/menuzord/css/menuzord-animations.css" rel="stylesheet">


  <link href='/assets/plugins/fancybox/jquery.fancybox.min.css' rel='stylesheet'>



  <link href='/assets/plugins/rateyo/jquery.rateyo.min.css' rel='stylesheet'>




  <link href='/assets/plugins/owl-carousel/owl.carousel.min.css' rel='stylesheet' media='screen'>
  <link href='/assets/plugins/owl-carousel/owl.theme.default.min.css' rel='stylesheet' media='screen'>


  <!-- GOOGLE FONT -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,500,600,700' rel='stylesheet'>

  <!-- CUSTOM CSS -->
  <link href="/assets/css/star.css" id="option_style" rel="stylesheet">
  <link href="/assets/css/custom.css" id="custom_style" rel="stylesheet">


  <!-- FAVICON -->
  <link rel="shortcut icon" type="image/png" href="/assets/img/favicon.png"/>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->


  <!-- axios, jquery 사용-->
  <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

  <!-- 구글 맵 사용 -->
  <!-- 맵 api key 삭제해야함 서버에서 환경변수값을 넘겨줘야 함-->
  <script type="text/javascript" src="https://maps.google.com/maps/api/js?key=AIzaSyBnEbknTcJ0sg7EJiuKhDkP8fNEke7HNMU" ></script>

  <style>
    #map_ma {width:100%; height:400px; clear:both; border:solid 1px red;}
  </style>

  <script>
    const post_id = new URL(window.location.href).pathname.replace("/post/", "");
    const config = { "Content-Type": "application/json" }

    async function permit(identifier) {
      try{
        const application_id = $(identifier).data('id')
        let body = {"applicationId" : application_id, "status" : 1}

        await axios.put('/application-rest/' + post_id, body, config);

        window.location.reload();
        return false;
      } catch (e) {
        console.log(e.response.data.result.errorCode);
        if (e.response.data.result.errorCode === "EXCEED_ENTRANT_NUM") {
          alert('참가 인원 수를 초과하였습니다.');
        }
      }
    }

    async function reject(identifier) {
      try{
        const application_id = $(identifier).data('id')
        let body = {"applicationId" : application_id, "status" : 2}

        await axios.put('/application-rest/' + post_id, body, config);

        window.location.reload();
        return false;
      } catch (e) {
        console.log(e);
      }
    }
  </script>
  <script type="text/javascript">
    $(document).ready(function() {

     const accessToken = localStorage.getItem("accessToken");
     let accessName;

      if (accessToken === null) {
        console.log("accessToken === null")
        $("#login_li").show();
        $("#user_li").hide();
      } else {
        console.log("accessToken !== null")
        $("#login_li").hide();
        $("#user_li").show();

        const payload = accessToken.split('.')[1];
        accessName = JSON.parse(decodeURIComponent(escape(window.atob(payload)))).userName;
        document.getElementById("userName").innerText = accessName;
      }
     console.log(accessName);



      <!-- PostId에 따른 데이터 호출하기 -->

      const postId = new URL(window.location.href).pathname.replace("/post/", "");

      console.log(postId);
      // axios header에 넣을 데이터
      const axiosConfig = {
        headers:{
          "Content-Type": "application/json"
        }
      }

      let jsonState;        // Json 반환 상태(성공인지 에러인지)
      let jsonResult;       // Json 반환 값 저장
      let jsonCommentState;        // Json 댓글 반환 상태(성공인지 에러인지)
      let jsonCommentResult;       // Json 댓글 반환 값 저장
      let jsonApplicationState;
      let title;
      let userName;    //  => writer로 사용 유저 아이디이름
      let content;
      let cost;
      var location;
      var lat;
      var lng;
      let untilRecruit;
      let entrantNum;
      let eventStart;
      let eventEnd;
      let status;
      let category;
      let fileName;
      let permitNum;


      const getdata = async()=>{
        try{
          const response = await axios.get('/post/'+postId+'/json');
          const commentresponse = await axios.get('/comment/'+postId+'/comments');
          // const applicationResponse = await axios.get('/application-rest/' + postId);
          console.log(response);     // json 데이터 받아온거


          jsonState = response.data.resultCode;
          jsonCommentState = commentresponse.data.resultCode;
          // jsonApplicationState = applicationResponse.data.resultCode;

          console.log(jsonState);
          console.log(jsonCommentState);
          console.log(jsonApplicationState);


          if(jsonCommentState == "SUCCESS") {
            console.log(commentresponse);

            var htmlentrantNum = document.getElementById("commentCount");
            htmlentrantNum.innerHTML = "댓글 " + "("+commentresponse.data.result.length+")";

            <!-- 댓글 리스트 출력 -->

            <!-- 댓글 리스트 html -->
            let commenthtml=
                    "<li class=\"comment-item\" id=\"comment1\">\n"+
                    "<div style='display: none' data-id=\"{댓글 아이디}\"></div>\n"+
                    "<a class=\"me-n4 comment-tool\" id=\"navbarDropdown\" href=\"#\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">. . .</a>\n"+
                    "<ul class=\"dropdown-menu droclassName-menu-end\" aria-labelledby=\"navbarDropdown\">\n" +
                    // "<li><a  class=\"dropdown-item\" hrclassName\">수정</a></li>\n"+
                    "<li><a data-id=\"{댓글 삭제}\" onclick=\'commentReplyDeleteButton(this)\' class=\"dropdown-item\" hrclassName\">삭제</a></li>\n"+
                    "</ul>\n"+
                    "<div>\n"+
                    "<div id=\"parentId\" style='display: none'>{postId}</div>\n"+
                    "<div>\n"+
                    "<p class=\"comment-username\" id=\"parentUsername\">{닉네임}</p>\n"+
                    "</div>\n"+
                    "<div>\n"+
                    "<p class=\"comment-content\">{내용}</p>\n"+
                    "</div>\n"+
                    "<div>\n"+
                    "<p class=\"comment-date\">{작성일자}</p>\n"+
                    "<a class=\"comment-date\" data-id=\"{댓글 노출}\" onclick=\"showCommentReply(this)\">댓글쓰기</a>\n"+
                    "<form class=\"comment-reply-form\" id=\"{댓글 노출2}\" style=\"display: none;\">\n"+
                    "<div class=\"form-group mb-2\">\n"+
                    "<textarea class=\"form-control border-0 bg-smoke\" id =\"{대댓글 작성}\" placeholder=\"Comment\" rows=\"2\"></textarea>\n"+
                    "</div>\n"+
                    "<div style=\"display: flex; justify-content: right\">\n"+
                    "<button type=\"button\" data-id=\"{댓글 아이디2}\" onclick=\"commentReplyButton(this)\"  class=\"btn btn-outline-info-comment-button mb-2\" style=\"padding: 8px 18px\">등록</button>\n"+
                    "</div>\n"+
                    "</form>\n"+
                    "</div>\n"+
                    "</div>\n"+
                    "</li>";

            <!-- 대댓글 리스트 html -->
            let reply_commenthtml=
                    "<li class=\"comment-reply\" id=\"comment2\">\n"+
                    "<div style='display: none' ></div>\n"+
                    "<a class=\"me-n4 comment-tool\" id=\"navbarDropdown\" href=\"#\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">. . .</a>\n"+
                    "<ul class=\"dropdown-menu droclassName-menu-end\" aria-labelledby=\"navbarDropdown\">\n" +
                    "<li><a data-id=\"{대댓글 삭제}\" onclick=\'commentReplyDeleteButton(this)\' class=\"dropdown-item\" hrclassName\">삭제</a></li>\n"+
                    "</ul>\n"+
                    "<div>\n"+
                    "<div>\n"+
                    "<p class=\"comment-username\">{닉네임}</p>\n"+
                    "</div>\n"+
                    "<div>\n"+
                    "<p class=\"comment-content\">{내용}</p>\n"+
                    "</div>\n"+
                    "<div>\n"+
                    "<p class=\"comment-date\">{작성일자}</p>\n"+
                    "</div>\n"+
                    "</div>\n"+
                    "</li>";

            let comment_list = commentresponse.data.result;         // 부모 댓글 리스트




            console.log(comment_list);
            comment_list.forEach(function (comment){        // 댓글 갯수만큼 반복
              let comment_parent_id = comment.parentId;
              console.log(comment_parent_id);
              let html_result = commenthtml.replace("{닉네임}",comment.userName)     // DB에 저장되어 있는 내용을 덮어씌워줌
                      .replace("{작성일자}",comment.createAt)
                      .replace("{내용}",comment.content)
                      .replace("{댓글 아이디}",comment.id)
                      .replace("{댓글 아이디2}",comment.id)
                      .replace("{댓글 노출}",'comment'+comment.id+'-'+comment.id)
                      .replace("{댓글 노출2}",'comment'+comment.id+'-'+comment.id)
                      .replace("{댓글 삭제}",comment.id)
                      .replace("{대댓글 작성}",'replyComment'+comment.id);

              let html_reply_result;
              if (comment.children.length != 0) {                     // 만약 대댓글이 있다면
                let reply_comment_list = comment.children;      // 대댓글 리스트 저장
                console.log(reply_comment_list);
                reply_comment_list.forEach(function (replycomment) {      // 대댓글 갯수만큼 반복
                  console.log(replycomment.parentId);
                  html_reply_result += reply_commenthtml.replace("{닉네임}", replycomment.userName)
                          .replace("{작성일자}", replycomment.createAt)
                          .replace("{내용}", replycomment.content)
                          .replace("{postId}",replycomment.parentId)
                          .replace("{대댓글 삭제}",replycomment.id);
                });

                let commentResult = document.getElementById('list_comment');          // 대댓글 html에 대댓글 갯수만큼 데이터를 넣어 저장한 후
                commentResult.innerHTML += (html_result+html_reply_result);           // 해당 부모 댓글 html에 더해서 출력
              }else{
                let commentResult = document.getElementById('list_comment');        // 대댓글이 없을 경우 댓글 html만 출력
                commentResult.innerHTML += html_result;
              }
            });





            <!-- 댓글 작성 -->
            $("#parentCommentButton").click(function() {

              var comment = $("#parentComment").val();   // 댓글 값 저장

              const CommentData = {       // 해외 데이터
                "content" : comment,         //  댓글 내용            comment
                "parentId" : null           // 일반 댓글은 부모댓글이 없으므로 null
              }

              console.log(CommentData);

              // axios header에 넣을 데이터
              const axiosConfig = {
                headers: {
                  "Content-Type": "application/json"
                }
              }

              const sendData = async () => {
                try {

                  const response = await axios.post('/comment/'+postId, JSON.stringify(CommentData), axiosConfig);
                  alert("전송 성공");
                  let url = "/post/" + postId;
                  window.location.replace(url);
                } catch (error) {
                  alert("404 페이지");
                }
              }
              sendData();
            });

          }else {
            alert("서버 반환값 Error임 404페이지 이동");
            console.log("댓글 없음");
          }

          if (jsonState == "SUCCESS") {

            jsonResult = response.data.result;
            console.log(jsonResult);

            title = jsonResult.title;
            userName = jsonResult.userName;
            content = jsonResult.content;
            cost = jsonResult.cost;
            location = jsonResult.location;
            lat = jsonResult.lat;
            lng = jsonResult.lng;
            untilRecruit = jsonResult.untilRecruit;
            entrantNum = jsonResult.entrantNum;
            eventStart = jsonResult.eventStart;
            eventEnd = jsonResult.eventEnd;
            status = jsonResult.status;
            category = jsonResult.category;
            fileName = jsonResult.fileName;
            permitNum = jsonResult.permitNum;

            if (status !== 'JOIN') {
              document.getElementById("application_button").style.display = 'none';
            }


            <!-- 포스트 수정,삭제 버튼 게시물 작성자만 뜨도록 설정 -->
              // window.onload = function () {
                let postUpdateButton = document.getElementById("postUpdateButton");
                let postDeleteButton = document.getElementById("postDeleteButton");

                console.log(postUpdateButton);
                console.log(postDeleteButton);

                console.log(accessName);
                console.log(userName);
                console.log(accessName == userName)
                if (accessName == userName) {
                  postUpdateButton.style.display = "block";
                  postDeleteButton.style.display = "block";
                } else {
                  postUpdateButton.style.display = "none";
                  postDeleteButton.style.display = "none";
                }
              // }
              // onload();


            googlemap(lat, lng, location, title, content);

            console.log(lat);
            console.log(lng);

            var htmlPostStatus = document.getElementById("postStatus");
            if (status === "JOIN") {
              htmlPostStatus.innerText = "모집중";
            } else if (status === "JOINCOMPLETE") {
              htmlPostStatus.innerText = "모집완료";
            }


            <!-- 포스트 데이터 출력 -->
            var htmlentrantNum = document.getElementById("entrantNum");
            htmlentrantNum.innerHTML = "현재 인원 :" + "(" + permitNum + "/" + entrantNum + ")";

            var htmltitle = document.getElementById("title");
            htmltitle.innerHTML = title;

            var htmluserName = document.getElementById("writer");
            htmluserName.innerHTML = userName;

            var htmluntil = document.getElementById("untilRecruit");
            htmluntil.innerHTML = "모집기간 : " + untilRecruit;

            var htmlevent = document.getElementById("eventStart");
            htmlevent.innerHTML = "일정 : " + eventStart + " ~ " + eventEnd;

            var htmlcost = document.getElementById("cost");
            htmlcost.innerHTML = "비용 : " + cost;

            var htmllocation = document.getElementById("location");
            htmllocation.innerHTML = "장소 : " + location;

            var htmlcontent = document.getElementById("content");
            htmlcontent.innerHTML = content;


            console.log(fileName);

            <!-- 이미지 출력 경로 지정 -->
            if(fileName == "noImage"){
              document.getElementById("image_box").src = "/assets/img/noImage.png";
            }else {
              document.getElementById("image_box").src = 'https://bucketlist-post-image-bucket.s3.ap-northeast-2.amazonaws.com/' + fileName;
            }

            const accessToken = localStorage.getItem("accessToken");
            const payload = accessToken.split('.')[1];
            let token_userName = JSON.parse(decodeURIComponent(escape(window.atob(payload)))).userName;

            if (userName === token_userName) {
              try{
              const applicationResponse = await axios.get('/application-rest/' + postId);
              jsonApplicationState = applicationResponse.data.resultCode;
              document.getElementById("application_button").style.display = 'none';

              if (jsonApplicationState === "SUCCESS") {
                console.log(applicationResponse);

                let application_html =
                        "<form class=\"\">\n" +
                        "            <h3 class=\"text-uppercase mb-3\" >{닉네임} / {나이} / {성별}</h3>\n" +
                        "\n" +
                        "            <div class=\"form-group mb-2\">\n" +
                        "              <textarea readonly class=\"form-control border-0 bg-smoke\" rows=\"3\">{내용}</textarea>\n" +
                        "            </div>\n" +
                        "\n" +
                        "            <div style=\"display: flex; justify-content: right\">\n" +
                        "              <button type=\"button\" class=\"btn btn-outline-success mb-2 mx-2\" data-id=\"{신청서 아이디}\" onclick=\"permit(this)\" style=\"padding: 8px 18px\">\n" +
                        "                수락\n" +
                        "              </button>\n" +
                        "              <button type=\"button\" class=\"btn btn-outline-danger mb-2 mx-2\" data-id=\"{신청서 아이디}\" onclick=\"reject(this)\" style=\"padding: 8px 18px\">\n" +
                        "                거절\n" +
                        "              </button>\n" +
                        "            </div>\n" +
                        "          </form>"
                applicationResponse.data.result.list.forEach(function (application) {
                  let application_html_result = application_html.replace("{닉네임}", application.userName)
                          .replace("{나이}", application.age)
                          .replace("{내용}", application.content)
                          .replace("{신청서 아이디}", application.id)
                          .replace("{신청서 아이디}", application.id);

                  if (application.gender === 'MAN') {
                    application_html_result = application_html_result.replace("{성별}", "남")
                  } else {
                    application_html_result = application_html_result.replace("{성별}", "여")
                  }

                  let application_box = document.getElementById('application-box');
                  application_box.innerHTML += application_html_result;
                })
              } else {
                console.log('asdasf');
              }
              }
              catch (e) {

              }


            }
            // }
            //
            // onload();

            console.log(location);
          } else {
            alert("서버 반환값 Error임 404페이지 이동");
            console.log("1개조회 실패")
          }


        }catch (ERROR){
          alert("404 에러");
        }
      }



      const googlemap = function(lat,lng,location,title,content){

        var myLatlng = new google.maps.LatLng(lat,lng); // 위치값 위도 경도
        var Y_point			= lat;		// Y 좌표
        var X_point			= lng;		// X 좌표
        var zoomLevel		= 18;				// 지도의 확대 레벨 : 숫자가 클수록 확대정도가 큼
        var markerTitle		= location;		// 현재 위치 마커에 마우스를 오버을때 나타나는 정보
        var markerMaxWidth	= 300;				// 마커를 클릭했을때 나타나는 말풍선의 최대 크기


// 말풍선 내용
        let contentString	= '<div>' +
                '<h2>{제목}</h2>'+
                '</div>';

        let contentResult = contentString.replace("{제목}",title);


        var myLatlng = new google.maps.LatLng(Y_point, X_point);
        var mapOptions = {
          zoom: zoomLevel,
          center: myLatlng,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        }
        var map = new google.maps.Map(document.getElementById('map_ma'), mapOptions);
        var marker = new google.maps.Marker({
          position: myLatlng,
          map: map,
          title: markerTitle
        });
        var infowindow = new google.maps.InfoWindow(
                {
                  content: contentResult,
                  maxWizzzdth: markerMaxWidth
                }
        );
        google.maps.event.addListener(marker, 'click', function() {
          infowindow.open(map, marker);
        });
      }

      getdata();

      <!-- 좋아요 -->
      console.log('getLike');
      axios.get('/post/' + postId + '/likes/check')
              .then((res) => {
                console.log(res.data);
                let likeCheck = res.data.result;
                let $likeBtn =$('.icon.heart');
                if (likeCheck == 1){
                  $likeBtn.toggleClass('active');
                  $likeBtn.find('img').attr({
                    'src': '/assets/img/like/full-heart.png',
                    alt:'찜하기 완료'
                  });
                }
              })
              .catch((err) => {
                console.log(err);
              });

      axios.get('/post/' + postId + '/likes')
              .then((res) => {
                console.log(res.data);
                let cntLike = res.data.result;
                document.getElementById("cntLike").innerText = cntLike;
              })
              .catch((err) => {
                console.log(err);
              });
    });

  </script>

  <script>


    <!-- 대댓글 댓글쓰기 누르면 댓글 작성창 띄움 -->
    function showCommentReply(commentReplyId) {
      console.log(commentReplyId);
      const Id = $(commentReplyId).data('id')
      console.log(Id);
      let search = document.getElementById(Id);
      console.log(search);
      let check = search.style.display;
      console.log(check);
      if(check == "none") {
        search.style.display="block";
      } else {
        search.style.display="none";
      }
    }

    <!-- 대댓글 작성 -->
    function commentReplyButton(comment) {
      const parentId = $(comment).data('id')

      let str = 'replyComment'+parentId;
      let name = document.getElementById(str);
      console.log(name);

      let temp = $("#"+str).val();

      console.log(temp);
      console.log(parentId);
      const CommentData = {       // 서버로 보낼 데이터
        "content" : temp,         //  댓글 내용            comment
        "parentId" : parentId // 부모댓글 ID가 들어가야함
      }

      console.log(CommentData);

      // axios header에 넣을 데이터
      const axiosConfig = {
        headers: {
          "Content-Type": "application/json"
        }
      }

      const sendData = async () => {
        try {

          const response = await axios.post('/comment/'+postId, JSON.stringify(CommentData), axiosConfig);
          alert("전송 성공");
          let url = "/post/" + postId;
          window.location.replace(url);
        } catch (error) {
          alert("실패");
        }
      }
      sendData();
    }


    <!-- 대댓글 삭제 -->
    function commentReplyDeleteButton(comment){
      const parentId = $(comment).data('id')
      console.log(parentId);

      const axiosConfig = {
        headers: {
          "Content-Type": "application/json"
        }
      }

      const sendData = async () => {
        try {
          const response = await axios.delete('/comment/'+postId+'/comments/'+parentId);
          alert("전송 성공");
          let url = "/post/" + postId;
          window.location.replace(url);
        } catch (error) {
          alert("실패");
        }
      }
      sendData();
    }

    const postId = new URL(window.location.href).pathname.replace("/post/", "");
    <!-- 포스트 수정 -->
    function updatePost(){
      const gotopostUpdate = async()=>{         // 포스트 수정 페이지 이동
        try{
          let url = "/post/" + postId+"/edit";
          window.location.replace(url);
        }catch (e){
          alert("수정 페이지 이동 불가능");
        }
      }

      gotopostUpdate();
    }


    <!-- 포스트 삭제 -->
    function deletePost() {
      const postDelete = async() => {
        try {
          await axios.delete('/post/' + postId);
          let url = "/post";
          window.location.replace(url);
        }catch (e){
        }
      }

      postDelete();
    }


  </script>
</head>

<body id="body" class="up-scroll">

<!-- ====================================
——— HEADER
===================================== -->
<header class="header" id="pageTop">
  <!-- Menu Zord -->
  <nav class="nav-menuzord navbar-sticky">
    <div class="container clearfix">
      <div id="menuzord" class="menuzord">
        <a href="/" class="menuzord-brand">
          <img class="lazyestload" data-src="/assets/img/logo-color-big.png" src="/assets/img/logo-color-big.png" alt="logo-img">
        </a>

        <ul class="menuzord-menu menuzord-right">
          <li class="">
            <a class="" href="javascript:void(0)">멤버십</a>
          </li>

          <li class="">
            <a class="" href="javascript:void(0)">버킷리스트</a>
            <ul class="dropdown drop-up">
              <li class="">
                <a href="/post">All</a>
              </li>

              <li class="">
                <a href="/post?category=travel">Travel</a>
              </li>

              <li class="">
                <a href="/post?category=extreme">Extreme</a>
              </li>

              <li class="">
                <a href="/post?category=study">Study</a>
              </li>

              <li class="">
                <a href="/post?category=volunteer">Volunteer</a>
              </li>

              <li class="">
                <a href="/post?category=experience">Experience</a>
              </li>

              <li class="">
                <a href="/post?category=etc">Etc</a>
              </li>
            </ul>
          </li>

          <li class="" id="login_li">
            <a class="" href="javascript:void(0)" data-bs-toggle="modal" data-bs-target="#login">로그인</a>
          </li>

          <li class="" id="user_li">
            <a class="" href="javascript:void(0)" id="userName">유저명</a>
            <ul class="dropdown drop-up">
              <li class="">
                <a href="/post/createform">버킷리스트 작성</a>
              </li>

              <li class="">
                <a href="/my/likes">좋아요</a>
              </li>

              <li class="">
                <a href="/my">마이 피드</a>
              </li>

              <li class="">
                <a href="index-3.html">마이페이지</a>
              </li>

              <li class="">
                <a href="#" onclick="logout(); return false;">로그아웃</a>
              </li>
            </ul>
          </li>

        </ul>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper packages-list-left-sidebar">


  <!-- ====================================
  ———	PAGE TITLE
  ===================================== -->
  <section class="page-title">
    <div class="page-title-img bg-img bg-overlay-darken" style="background-image: url(/assets/img/pages/page-title-bg13.jpg);">
      <div class="container">
        <div class="row align-items-center justify-content-center" style="height: 200px;">
          <div class="col-lg-6">
            <div class="page-title-content">
              <div class="title-border">
                <h2 class="text-uppercase text-white font-weight-bold" id="postStatus">모집중</h2>
              </div>
              <p class="text-white mb-0" id="entrantNum">현재 인원 : (3 / 5)</p>
              <div class="right_area pt-2" style="display: flex; justify-content: center">
                <a href="javascript:void(0);" class="icon heart">
                  <img src="/assets/img/like/blank-heart.png" alt="찜하기">
                </a>
                <div class="cntLike">
                  <p id="cntLike">0</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>


  <!-- ====================================
  ———	PACKAGES SECTION
  ===================================== -->
  <section class="py-8">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="mt-n7" style="float: right">
            <button type="button" id="postUpdateButton" onclick="updatePost()" class="btn btn-outline-dark mb-2" style="padding: 8px 18px; display: none">수정</button>
            <button type="button" id="postDeleteButton" onclick="deletePost()" class="btn btn-outline-dark mb-2" style="padding: 8px 18px; display: none">삭제</button>
          </div>
          <div>
            <h2 class="text-uppercase mb-2" id="title"></h2>
            <h4 class="text-uppercase mb-5" id="writer"></h4>

            <div class="mb-5">
              <div class="row">
                <div class="col-md-12">
                  <ul class="list-unstyled mb-0">
                    <li class="media">
                      <div class="text-gray-color me-2">
                        <i class="far fa-dot-circle" aria-hidden="true"></i>
                      </div>
                      <div class="media-body">
                        <p id="untilRecruit"></p>
                      </div>
                    </li>


                    <li class="media">
                      <div class="text-gray-color me-2">
                        <i class="far fa-dot-circle" aria-hidden="true"></i>
                      </div>
                      <div class="media-body">
                        <p id="eventStart"></p>
                      </div>
                    </li>

                    <li class="media">
                      <div class="text-gray-color me-2">
                        <i class="far fa-dot-circle" aria-hidden="true"></i>
                      </div>
                      <div class="media-body">
                        <p id="cost"></p>
                      </div>
                    </li>

                    <li class="media">
                      <div class="text-gray-color me-2">
                        <i class="far fa-dot-circle" aria-hidden="true"></i>
                      </div>
                      <div class="media-body">
                        <p id="location"></p>
                      </div>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <div class="mb-6">
            <div class="row">

              <!-- 구글 맵 출력 부분-->
              <div style="width:400px; height:400px;" id="map_ma"></div>

              <!-- 이미지 출력 부분 -->
              <!--              <div id="package-slider" class="owl-carousel owl-theme package-slider col-md-6">-->
              <!--              <div id="package-slider" class="owl-carousel owl-theme package-slider col-md-6">-->
              <div class="item">
<!--                                <img class="lazyestload" src="/assets/img/packages/package-slider-03.jpg" alt="image">-->
                <img id="image_box" class="lazyestload" src="" alt="image">
              </div>

              <!--              <div class="item">-->
              <!--                <img id="image_box" class="lazyestload" src="/assets/img/packages/package-slider-03.jpg" alt="image">-->
              <!--              </div>-->

              <!--                <div class="item">-->
              <!--                  <img class="lazyestload" data-src="/assets/img/packages/package-slider-04.jpg" src="/assets/img/packages/package-slider-04.jpg" alt="image">-->
              <!--                </div>-->

              <!--                <div class="item">-->
              <!--                  <img class="lazyestload" data-src="/assets/img/packages/package-slider-05.jpg" src="/assets/img/packages/package-slider-05.jpg" alt="image">-->
              <!--                </div>-->
            </div>
          </div>
          <p class="my-6" id="content">설명 내용</p>
        </div>

          <div class="mb-5" style="display: flex; justify-content: center">
            <button id="application_button" type="button" class="btn btn-primary mb-2" onclick="goToApplication()">참가하기</button>
          </div>

          <!-- ----------------------- 신청서 출력 부분 ----------------------- -->
        <div id="application-box">
          <h2 class="text-uppercase mb-6">신청 현황</h2>
          <!-- 신청서 리스트 출력 부분 -->
          <!-- 신청서 리스트 출력 부분 -->
        </div>

        <!-- ----------------------- 댓글 출력 부분 ----------------------- -->
        <div class="comment-box">
          <form class="">
            <h3 class="text-uppercase mb-6" id="commentCount">댓글 (댓글 수?)</h3>

            <div class="form-group mb-2">
              <textarea class="form-control border-0 bg-smoke" id="parentComment" placeholder="Comment" rows="3"></textarea>
            </div>

            <div style="display: flex; justify-content: right">
              <button id="parentCommentButton" type="button" class="btn btn-outline-info-comment-button mb-2" style="padding: 8px 18px">
                등록
              </button>
            </div>
          </form>

          <ul class="comment-list">
            <div id="list_comment">
              <!-- 댓글 리스트 출력 부분 -->
            </div>
            <div id="reply_list_comment">
              <!-- 대댓글 리스트 출력 부분 -->
            </div>
          </ul>
        </div>

        <!-- ----------------------- 댓글 출력 부분 ----------------------- -->

      </div>
    </div>
  </section>


</div><!-- element wrapper ends -->

<!-- ====================================
——— FOOTER SECTION
===================================== -->
<footer class="footer">
  <div class="footer-bg-color py-9">
    <div class="container">
      <div class="row">
        <div class="col-md-6 col-lg-3 mb-5 mb-lg-0 mx-5">
          <a class="d-inline-block" href="index.html">
            <img class="w-100 mb-6 lazyestload" data-src="/assets/img/logo-color-sm.png"
                 src="/assets/img/logo-color-sm.png" alt="img">
          </a>
          <p class="mb-0">멋쟁이 사자처럼 백엔드 스쿨 2기에서 진행한 팀프로젝트입니다.
            버킷리스트를 주제로 비슷한 목표를 가진 사람들이 모여 값진 경험을 할 수 있는 사이트를 구현했습니다.
            글을 작성하여 사람을 모집할 수 있으며 버킷리스트 개설자는 참가 신청한 참가자를 허가/거부할 수 있습니다.
            모집이 완료되면 채팅이 활성화되고 일정을 마친 후에 참가자는 버킷리스트와 호스트에 대해서 평가할 수 있습니다.
          </p>
        </div>

        <!--각자 깃랩 링크 걸건지?-->
        <div class="col-md-6 col-lg-3 mt-md-4 mb-5 mb-lg-0 mx-7">
          <div class="title-tag">
            <h6>Team9 : WEB (WE are Best)</h6>
          </div>
          <ul class="list-unstyled mb-0">
            <li class="media mb-2">
              <div class="me-3">
                <i class="fa-regular fa-user"></i>
              </div>
              <div class="media-body">
                <a href="#" target="_blank">PM : 최수정</a>
              </div>
            </li>
            <li class="media mb-2">
              <div class="me-3">
                <i class="fa-regular fa-user"></i>
              </div>
              <div class="media-body">
                <a href="#" target="_blank">CTO : 정재현</a>
              </div>
            </li>

            <li class="media mb-2">
              <div class="me-3">
                <i class="fa-regular fa-user"></i>
              </div>
              <div class="media-body">
                <a href="#" target="_blank">개발 : 고관운</a>
              </div>
            </li>

            <li class="media mb-2">
              <div class="me-3">
                <i class="fa-regular fa-user"></i>
              </div>
              <div class="media-body">
                <a href="#" target="_blank">개발 : 박은빈</a>
              </div>
            </li>

            <li class="media mb-2">
              <div class="me-3">
                <i class="fa-regular fa-user"></i>
              </div>
              <div class="media-body">
                <a href="#" target="_blank">개발 : 배지원</a>
              </div>
            </li>

            <li class="media mb-2">
              <div class="me-3">
                <i class="fa-regular fa-user"></i>
              </div>
              <div class="media-body">
                <a href="#" target="_blank">개발 : 변지환</a>
              </div>
            </li>
          </ul>
        </div>

        <div class="col-md-6 col-lg-3 mt-md-4 mb-5 mb-lg-0 mx-5">
          <div class="title-tag">
            <h6>Contact us</h6>
          </div>
          <ul class="list-unstyled mb-0">
            <li class="media mb-2">
              <div class="me-3">
                <i class="fa-brands fa-gitlab"></i>
              </div>
              <div class="media-body">
                <a href="https://gitlab.com/S2uJeong1/bucketlist" target="_blank">team project
                  gitlab</a>
              </div>
            </li>

            <li class="media mb-2">
              <div class="me-3">
                <i class="fa-regular fa-file"></i>
              </div>
              <div class="media-body">
                <a href="https://ringed-suggestion-46f.notion.site/ceff928e9f1f4e2482f07387b997f593"
                   target="_blank">team project notion</a>
              </div>
            </li>

            <li class="media">
              <div class="me-3">
                <i class="far fa-envelope" aria-hidden="true"></i>
              </div>
              <!--                            <div class="media-body">-->
              <!--                                <a href="mailTo:info@star-travel.com">이메일 넣을까 말까</a>-->
              <!--                            </div>-->
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="copyright py-6">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-6 order-1 order-md-0">
          <p class="mb-0 mb-md-0 text-md-start">Copyright &copy; <span id="copy-year"></span> All Rights
            Reserved by
            <a href="http://www.iamabdus.com/" target="_blank">Abdus</a>
          </p>
        </div>
      </div>
    </div>
  </div>

<!-- ====================================
——— MODAL SECTION
===================================== -->
<!-- Signup Modal -->
<div class="modal fade" id="signup" tabindex="-1" role="dialog" aria-label="signupModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header rounded">
        <h3 class="modal-title text-uppercase font-weight-bold">회원가입</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <form onsubmit="join(); return false;">
          <div class="mb-3">
            <div class="mb-3" style="display: flex">
              <input type="text" id="form_userName" class="form-control bg-smoke" required="" placeholder="닉네임">
              <button class="btn btn-facebook btn-block text-uppercase text-white" onclick="checkUserName()" style="width: 25%; padding: 0">중복확인</button>
            </div>
            <p id="able_userName" style="display: none">사용 가능한 닉네임 입니다.</p>
            <p id="error_userName" style="display: none">중복되는 닉네임 입니다.</p>
          </div>

          <div class="mb-3">
            <input type="password" id="pw" class="form-control bg-smoke" required="" placeholder="비밀번호">
            <input type="password" id="check_pw" onchange="checkPasswordCorrect()" class="form-control bg-smoke" required="" placeholder="비밀번호 확인">
            <p id="error_passwordCorrect" style="display: none">일치하지 않습니다.</p>
          </div>

          <div class="mb-3">
            <select id="form_gender" class="form-control bg-smoke">
              <option value="">성별</option>
              <option value="MAN">남자</option>
              <option value="WOMAN">여자</option>
            </select>
            <p id="error_gender" style="display: none">성별을 선택 해주세요.</p>
          </div>

          <div class="mb-3">
            <input type="number" id="age" class="form-control bg-smoke" required="" placeholder="나이">
          </div>
          <!--              <div class="mb-3" style="display: flex">-->
          <!--                <input style="flex: 1;" id="birth_year" type="year" class="form-control bg-smoke" required="" placeholder="년(4자)">-->
          <!--                <input style="flex: 1;" id="birth_month" type="month1" class="form-control bg-smoke" required="" placeholder="월">-->
          <!--                <input style="flex: 1;" id="birth_day" type="day" class="form-control bg-smoke" required="" placeholder="일">-->
          <!--              </div>-->

          <div class="mb-3">
            <div style="display: flex">
              <input style="flex: auto;" type="email" class="form-control bg-smoke" required="" placeholder="이메일" id="form_email">
              <button class="btn btn-facebook btn-block text-uppercase text-white" onclick="checkEmail()" style="width: 25%; padding: 0">인증요청</button>
            </div>
            <p id="error_email" style="display: none">중복된 이메일 입니다.</p>
            <input type="emailCheck" id="code" class="form-control bg-smoke" required="" placeholder="인증번호">
            <p id="error_code" style="display: none">인증 코드가 불일치 합니다.</p>

          </div>

          <div class="mb-3 form-check mb-0">
            <input type="checkbox" class="form-check-input" id="exampleCheck4">
            <label class="form-check-label text-gray-color mb-3" for="exampleCheck4">
              I agree to the terms of use and privacy.
            </label>
          </div>

          <div class="d-grid">
            <button type="submit" class="btn btn-primary btn-block text-uppercase">가입하기</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Login Modal -->
<div class="modal fade" id="login" tabindex="-1" role="dialog" aria-label="loginModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header rounded">
        <h3 class="modal-title text-uppercase font-weight-bold">로그인</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <form class="" onsubmit="return false;">
          <div class="mb-3">
            <input type="email" id="email" class="form-control bg-smoke" required="" placeholder="이메일">
          </div>

          <div class="mb-3">
            <input type="password" id="password" class="form-control bg-smoke" required="" placeholder="비밀번호">
          </div>

          <!--              <div class="mb-3 form-check mb-0">-->
          <!--                <input type="checkbox" class="form-check-input" id="exampleCheck5">-->
          <!--                <label class="form-check-label text-gray-color mb-3" for="exampleCheck5">-->
          <!--                  Remember me-->
          <!--                </label>-->
          <!--                <a class="pull-right" href="javascript:void(0)">Fogot Password?</a>-->
          <!--             </div>-->
          <p id="login_error" style="display: none"></p>
          <div class="d-grid">
            <button class="btn btn-primary text-uppercase" onclick="login(); return false;">Login</button>
          </div>

          <div class="text-uppercase text-center py-3">Or</div>

          <div style="display: flex;">
            <div style="flex: 1;">
              <a href="/login/google"><img src="/assets/img/google-button.png" style="width: 95%; margin-left: 5%"></a>
            </div>
            <div style="flex: 1;">
              <a href="/login/naver"><img src="/assets/img/naver-button.png" style="width: 85%; float: right; margin-right: 10%"></a>
            </div>
          </div>
        </form>
      </div>

      <div class="modal-footer justify-content-center">
        <p class="mb-1">Don’t have an Account? <a href="javascript:void(0)" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#signup">Sign up</a></p>
      </div>
    </div>
  </div>
</div>

<!-- INQUIRY IN MODAL -->
<div class="modal fade" id="inquiry" tabindex="-1" role="dialog" aria-label="inquiryModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header rounded">
        <h3 class="modal-title text-uppercase font-weight-bold">Inquiry about tour</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body pb-3">
        <form class="" action="index.html" method="post">
          <div class="mb-3">
            <input type="text" class="form-control bg-smoke" required="" placeholder="Your Name">
          </div>

          <div class="mb-3">
            <input type="email" class="form-control bg-smoke" required="" placeholder="Your Email">
          </div>

          <div class="mb-3">
            <input type="number" class="form-control bg-smoke" required="" placeholder="Phone Number">
          </div>

          <div class="mb-3">
            <textarea class="form-control bg-smoke" rows="6" placeholder="Message"></textarea>
          </div>

          <button type="submit" class="btn btn-primary text-uppercase">Submit</button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Javascript -->
<script src="/assets/plugins/jquery/jquery-3.4.1.min.js"></script>
<script src="/assets/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="/assets/plugins/menuzord/js/menuzord.js"></script>



<script src='/assets/plugins/fancybox/jquery.fancybox.min.js'></script>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>



<script>
  //heart 좋아요 클릭시! 하트 뿅
  $(function(){
    var $likeBtn =$('.icon.heart');

    $likeBtn.click(function(){
      const postId = new URL(window.location.href).pathname.replace("/post/", "");
      console.log(postId);

      $likeBtn.toggleClass('active');
      if($likeBtn.hasClass('active')){
        axios.post('/post/' + postId + '/likes')
                .then((res) => {
                  console.log(res.data);

                  $(this).find('img').attr({
                    'src': '/assets/img/like/full-heart.png',
                    alt:'찜하기 완료'
                  });

                  axios.get('/post/' + postId + '/likes')
                          .then((res) => {
                            console.log(res.data);
                            let cntLike = res.data.result;
                            document.getElementById("cntLike").innerText = cntLike;
                          })
                          .catch((err) => {
                            console.log(err);
                          })
                })
                .catch((err) => {
                  console.log(err);
                  alert("로그인 후 이용해주세요.")
                })
      }else{
        axios.post('/post/' + postId + '/likes')
                .then((res) => {
                  console.log(res.data);

                  $(this).find('i').removeClass('fas').addClass('far')
                  $(this).find('img').attr({
                    'src': '/assets/img/like/blank-heart.png',
                    alt:"찜하기"
                  })

                  axios.get('/post/' + postId + '/likes')
                          .then((res) => {
                            console.log(res.data);
                            let cntLike = res.data.result;
                            document.getElementById("cntLike").innerText = cntLike;
                          })
                          .catch((err) => {
                            console.log(err);
                          })
                })
                .catch((err) => {
                  console.log(err);
                  alert("로그인 후 이용해주세요.")
                })
      }
    })
  })

  function goToApplication() {
    let accessToken = localStorage.getItem("accessToken")
    if (accessToken === null) {
      alert("로그인이 필요한 서비스 입니다.");
      window.location.reload();
    } else {
      const postId = new URL(window.location.href).pathname.replace("/post/", "");
      window.location.href = '/app/form/' + postId;
    }
  }

  axios.interceptors.request.use(function(config) {
    const accessToken = localStorage.getItem('accessToken');
    if(accessToken) {
      config.headers.Authorization = 'Bearer' + ' ' + accessToken
    }
    return config;
  })

  axios.interceptors.response.use(
          success => success,
          async(error) => {
            console.log(error);
            const status = error.response.status

            if(status === 401) {
              const originRequest = error.config

              await axios.post('/reissue')
                      .then(response => {
                        console.log(response.data);
                        localStorage.setItem("accessToken", response.data);
                        originRequest.headers.authorization = 'Bearer ' + response.data;
                        return axios(originRequest);
                      })
                      .catch(error => {
                        console.log('재발급 실패, refresh token 만료');
                        localStorage.removeItem('accessToken')
                        window.location.href = '/';
                      })
              return Promise.reject(error);
            }
            return Promise.reject(error);
          }
  )
</script>



<script src='/assets/plugins/rateyo/jquery.rateyo.min.js'></script>
<script src="/assets/plugins/lazyestload/lazyestload.js"></script>





<script src='/assets/plugins/owl-carousel/owl.carousel.min.js'></script>


<script src="/assets/plugins/smoothscroll/SmoothScroll.js"></script>
<script src="/assets/js/star.js"></script>

<script src="/assets/js/custom.js"></script>
<script src="/js/header.js"></script>


</body>
</html>